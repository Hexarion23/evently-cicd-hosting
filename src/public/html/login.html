<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Login - Evently</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.min.css" />
    <link rel="stylesheet" href="../css/styles.css" />
    <link rel="stylesheet" href="../css/chatbot.css" />

    <style>
      .auth-page {
        min-height: 100vh;
        display: flex;
        background: linear-gradient(135deg, #FAFBFC 0%, #F1F3F5 100%);
      }
      .auth-left {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 2rem;
      }
      .auth-right {
        flex: 1;
        /* UPDATED: Red overlay opacity reduced to 0.65 for better visibility of the image */
        background: linear-gradient(135deg, rgba(200, 16, 46, 0.65), rgba(160, 13, 36, 0.65)), 
                    url('../assets/sp_img1.jpg');
        background-size: cover;
        background-position: center;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 3rem;
        position: relative;
        overflow: hidden;
      }
      @media (min-width: 992px) {
        .auth-right { display: flex; }
      }
      .auth-right-content {
        position: relative;
        z-index: 1;
        color: white;
        text-align: center;
        max-width: 400px;
      }
      .auth-right-content h2 { font-size: 2.5rem; font-weight: 800; margin-bottom: 1rem; letter-spacing: -0.02em; }
      .auth-right-content p { font-size: 1.1rem; opacity: 0.9; line-height: 1.6; }
      .auth-card {
        width: 100%;
        max-width: 440px;
        background: white;
        border-radius: 24px;
        padding: 2.5rem;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
        border: 1px solid #E9ECEF;
      }
      .auth-brand { text-align: center; margin-bottom: 2rem; }
      .auth-title { text-align: center; margin-bottom: 2rem; }
      .auth-title h1 { font-size: 1.75rem; font-weight: 700; color: #111827; margin-bottom: 0.5rem; }
      .auth-title p { color: #6C757D; font-size: 0.95rem; }
      .auth-form .form-control { padding: 0.875rem 1rem; border-radius: 12px; }
      .auth-form .form-control:focus { border-color: #C8102E; box-shadow: 0 0 0 4px rgba(200, 16, 46, 0.1); }
      .btn-auth {
        width: 100%; padding: 0.875rem; font-weight: 600; border-radius: 12px;
        background: linear-gradient(135deg, #C8102E 0%, #A00D24 100%);
        border: none; color: white; box-shadow: 0 8px 20px rgba(200, 16, 46, 0.3);
      }
      .btn-auth:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(200, 16, 46, 0.4); }
      .divider { display: flex; align-items: center; gap: 1rem; margin: 1.5rem 0; color: #ADB5BD; font-size: 0.85rem; }
      .divider::before, .divider::after { content: ''; flex: 1; height: 1px; background: #E9ECEF; }
    </style>
  </head>
  <body>
    <div class="auth-page">
      <div class="auth-left">
        <div class="w-100" style="max-width: 440px; margin-bottom: 1rem;">
            <a href="index.html" class="text-decoration-none text-muted fw-medium d-flex align-items-center gap-2">
                <i class="bi bi-arrow-left"></i> Back to Home
            </a>
        </div>

        <div class="auth-card">
          <div class="text-center mb-4">
            <div class="d-flex align-items-center justify-content-center gap-2 mb-2">
                <img src="../assets/sp_logo.jpg" alt="SP Logo" style="height: 32px; width: auto;">
                <span class="fw-bold" style="color: #333;">Singapore Polytechnic</span>
            </div>
          </div>
          <div class="auth-title">
            <h1>Welcome back</h1>
            <p>Sign in to your account to continue</p>
          </div>
          <div id="login-error-box" class="alert alert-danger mb-3" style="display: none"></div>
          <form id="loginForm" class="auth-form">
            <div class="mb-3">
              <label class="form-label fw-semibold">Admin Number / Staff ID or Email</label>
              <input type="text" class="form-control" id="identifier" placeholder="P1234567, S1234567 or you@ichat.sp.edu.sg" required />
            </div>
            <div class="mb-4">
              <label class="form-label fw-semibold">Password</label>
              <div class="input-group">
                <input type="password" class="form-control" id="password" placeholder="Enter your password" required style="border-right: none;" />
                <button class="btn bg-white border border-start-0" type="button" id="toggleLoginPw" style="border-radius: 0 12px 12px 0;">
                  <i class="bi bi-eye text-muted"></i>
                </button>
              </div>
            </div>
            <button class="btn btn-auth" type="submit">Sign In <i class="bi bi-arrow-right ms-2"></i></button>
            <div class="divider">or</div>
            <div class="text-center">
              <p class="text-muted mb-2">Don't have an account?</p>
              <a href="register.html" class="fw-bold text-decoration-none" style="color: #C8102E;">Create Account</a>
            </div>
            <div class="auth-footer text-center mt-3 pt-3 border-top">
              <small class="text-muted d-block mb-2">Staff Member?</small>
              <a href="register-teacher.html" class="text-decoration-none fw-semibold" style="color: #C8102E;">Register as Teacher</a>
            </div>
          </form>
        </div>
      </div>

      <div class="auth-right">
        <div class="auth-right-content">
          <h2>Your campus events, simplified.</h2>
          <p>Evently helps Singapore Polytechnic students discover, sign up, and track events all in one place. Earn CCA points effortlessly.</p>
          <div class="mt-4 d-flex justify-content-center gap-4">
            <div class="text-center"><div class="h3 fw-bold mb-0">50+</div><small class="opacity-75">Active CCAs</small></div>
            <div class="text-center"><div class="h3 fw-bold mb-0">200+</div><small class="opacity-75">Events Monthly</small></div>
          </div>
        </div>
      </div>
    </div>
    
    <script>
      window.localStorage.removeItem("supabase.auth.token");
      document.cookie = "sb-access-token=; Max-Age=0; path=/;";
      document.cookie = "sb-refresh-token=; Max-Age=0; path=/;";
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script src="../js/auth.js"></script>
    <script>
        const auth = new Auth();
        document.getElementById('loginForm').addEventListener('submit', (e) => auth.login(e));
        
        // Toggle Password Visibility
        document.getElementById('toggleLoginPw').addEventListener('click', function() {
            const pwInput = document.getElementById('password');
            const icon = this.querySelector('i');
            if (pwInput.type === 'password') {
                pwInput.type = 'text';
                icon.classList.remove('bi-eye');
                icon.classList.add('bi-eye-slash');
            } else {
                pwInput.type = 'password';
                icon.classList.remove('bi-eye-slash');
                icon.classList.add('bi-eye');
            }
        });
    </script>
    <link rel="stylesheet" href="../css/chatbot.css" />
    <div id="chatbot-container">
      <button id="chatbot-fab" class="chatbot-fab" title="Open AI Assistant"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg></button>
      <div id="chatbot-modal" class="chatbot-modal hidden">
        <div class="chatbot-header"><div class="chatbot-title"><h3>AI Assistant</h3><p>Ask me anything about Evently</p></div><button id="chatbot-close" class="chatbot-close"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div>
        <div id="chatbot-messages" class="chatbot-messages"><div class="chatbot-message bot-message"><div class="message-content"><p>Hi! I'm your AI Assistant. How can I help you today?</p></div></div></div>
        <div class="chatbot-input-area"><input id="chatbot-input" type="text" class="chatbot-input" placeholder="Type your message..." autocomplete="off" /><button id="chatbot-send" class="chatbot-send"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg></button></div>
      </div>
    </div>
    <script src="../js/chatbot.js"></script>
   
  </body>
</html>