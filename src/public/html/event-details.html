<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Event Details - Evently</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="../css/styles.css" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
    />
  </head>

  <body class="app-shell">
    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
      <div class="container-fluid px-4">
        <a class="navbar-brand d-flex align-items-center gap-2">
          <img src="../assets/sp_logo.jpg" alt="SP Logo" class="sp-logo" style="height: 32px; width: auto;">
          <span class="fw-bold d-none d-sm-block">Singapore Polytechnic</span>
          <span class="mx-1 text-muted" style="opacity: 0.4;">|</span>
          <span class="text-gradient fw-bold">Evently</span>
        </a>

        <button
          class="navbar-toggler border-0"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0 gap-1 ms-3">
            <li class="nav-item">
              <a class="nav-link" href="dashboard.html">Dashboard</a>
            </li>

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                My Hub
              </a>
              <ul class="dropdown-menu border-0 shadow-sm">
                <li><a class="dropdown-item" href="calendar.html"><i class="bi bi-calendar-event me-2"></i>My Calendar</a></li>
                <li><a class="dropdown-item" href="past-events.html"><i class="bi bi-clock-history me-2"></i>History</a></li>
                <div id="exco-only-content" style="display: none">
                  <li><hr class="dropdown-divider" /></li>
                  <li>
                    <a class="dropdown-item" href="analytics.html"
                      ><i class="bi bi-bar-chart me-2"></i>CCA Analytics</a
                    >
                  </li>
                </div>              </ul>
            </li>

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                Tools
              </a>
              <ul class="dropdown-menu border-0 shadow-sm" id="toolsDropdownMenu">
                <li><a class="dropdown-item" href="qr-scanner.html"><i class="bi bi-qr-code-scan me-2"></i>QR Scanner</a></li>
              </ul>
            </li>
          </ul>

          <ul class="navbar-nav ms-auto align-items-center gap-3">
            <li class="nav-item">
              <a href="messenger.html" class="nav-link position-relative" id="nav-messenger" title="Messenger">
                <i class="bi bi-chat-dots fs-5"></i>
              </a>
            </li>

            <li class="nav-item dropdown">
              <button
                class="notification-btn"
                id="notificationDropdown"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="bi bi-bell-fill"></i>
                <span class="notification-badge" id="notificationBadge">0</span>
              </button>

              <div class="dropdown-menu dropdown-menu-end notification-dropdown" id="notificationMenu">
                <div class="notification-header">
                  <div class="notification-header-title">
                    <h6><i class="bi bi-bell-fill"></i> Notifications</h6>
                    <span class="notification-count-badge" id="notificationCountBadge">0 new</span>
                  </div>
                  <div class="notification-actions">
                    <button class="notification-action-btn" id="markAllReadBtn" onclick="markAllAsRead()">
                      <i class="bi bi-check2-all"></i> Mark all read
                    </button>
                  </div>
                </div>
                
                <div class="notification-list" id="notificationList">
                  </div>
                
                <div class="notification-footer">
                  <a href="notifications.html">
                    <span>See all notifications</span>
                    <i class="bi bi-arrow-right"></i>
                  </a>
                </div>
              </div>
            </li>

            <li class="nav-item">
              <a class="nav-link fw-semibold text-dark" href="profile.html">Profile</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container py-4">
      <div id="loadingState" class="text-center py-5">
        <div class="spinner-border text-primary"></div>
        <p class="mt-3 text-muted">Loading event details...</p>
      </div>

      <div id="eventContent" class="d-none">
        <div class="card border-0 shadow-sm mb-4">
          <img
            id="eventImage"
            class="card-img-top"
            style="height: 320px; object-fit: cover"
          />

          <div class="card-body">
            <h1 id="eventTitle" class="fw-bold mb-2"></h1>
            <p id="eventDescription" class="text-muted"></p>

            <div class="row mt-3 text-muted">
              <div class="col-md-4">
                <i class="bi bi-calendar-event"></i>
                <span id="eventDate"></span>
              </div>

              <div class="col-md-4">
                <i class="bi bi-clock"></i>
                <span id="eventTime"></span>
              </div>

              <div class="col-md-4">
                <i class="bi bi-geo-alt"></i>
                <span id="eventLocation"></span>
              </div>
            </div>

            <div class="row mt-2 text-muted">
              <div class="col-md-6">
                <i class="bi bi-clock-history"></i>
                <strong class="ms-2">Sign-up Deadline:</strong>
                <span id="eventSignupDeadline" class="ms-1"></span>
              </div>

              <div class="col-md-6">
                <i class="bi bi-award"></i>
                <strong class="ms-2">Points Awarded (numeric):</strong>
                <span id="ccaPointsNumber" class="ms-1 fw-semibold text-primary"></span>
              </div>
            </div>

            <div class="mt-3 d-flex align-items-center justify-content-between flex-wrap gap-3">

  <div class="d-flex flex-column">

    <div class="d-flex align-items-center mb-1">
      <button id="signupBtn" class="btn btn-primary me-3">Sign Up</button>
      <small id="signupStatus" class="text-muted"></small>
    </div>

    <div id="promotionTimerContainer" class="mt-2 d-none">
  <div class="alert alert-info py-2 px-3 mb-0">
    <strong>ðŸŽ‰ Youâ€™ve been promoted from the waitlist!</strong><br>
    <span>You have <span id="promotionTimer" class="fw-bold"></span> left to claim your slot.</span>
  </div>
</div>


    <div id="waitlistInfoBox" class="mt-1 text-muted small" style="display:none;">
      <div id="waitlistPosition"></div>
      <div id="promotionTimer"></div>
      <div id="promotionExpired"></div>
    </div>

  </div>

  <div id="qrCodeContainer" class="d-none text-center">
    <small class="text-muted d-block mb-2">Event QR Code</small>
    <img id="eventQrCode" style="width: 120px; height: 120px; border: 1px solid #ddd; padding: 4px;" />
    <br />
    <a id="downloadQrBtn" href="#" download class="btn btn-sm btn-outline-primary mt-2">
      <i class="bi bi-download me-1"></i> Download
    </a>
  </div>

</div>

              

        <div class="card border-0 shadow-sm mb-4">
          <div class="card-body">
            <h4 class="fw-bold mb-3">Event Information</h4>

            <div class="row mb-2">
              <div class="col-md-6">
                <strong>Organized By (CCA):</strong>
                <span id="eventOrganizedBy"></span>
              </div>

              <div class="col-md-6">
                <strong>Capacity:</strong>
                <span id="eventCapacity"></span>
              </div>
            </div>

            <div class="row mb-2">
              <div class="col-md-6">
                <strong>Visibility:</strong>
                <span id="eventVisibility"></span>
              </div>

              <div class="col-md-6">
                <strong>Status:</strong>
                <span id="eventStatus"></span>
              </div>
            </div>

            <div class="row mb-2">
              <div class="col-md-6">
                <strong>CCA Points Category:</strong>
                <span id="ccaPointsCategory"></span>
              </div>

              <div class="col-md-6">
                <strong>Points Awarded:</strong>
                <span
                  id="ccaPointsValue"
                  class="ms-1 fw-semibold text-primary"
                ></span>
              </div>
            </div>
          </div>
        </div>

        <div class="card border-0 shadow-sm mb-4">
          <div class="card-body">
            <h4 class="fw-bold mb-3">Event Details</h4>

            <div class="mb-3">
              <h6 class="fw-semibold mb-1">Agenda</h6>
              <p id="eventAgenda" class="mb-0 text-muted"></p>
            </div>

            <div class="mb-3">
              <h6 class="fw-semibold mb-1">Requirements</h6>
              <p id="eventRequirements" class="mb-0 text-muted"></p>
            </div>

            <div class="mb-3">
              <h6 class="fw-semibold mb-1">Safety Guidelines</h6>
              <p id="eventSafety" class="mb-0 text-muted"></p>
            </div>

            <div class="mb-3">
              <h6 class="fw-semibold mb-1">Additional Notes</h6>
              <p id="eventNotes" class="mb-0 text-muted"></p>
            </div>
          </div>
        </div>
        
        <div class="modal fade" id="editEventModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content shadow">

      <div class="modal-header">
        <h5 class="modal-title fw-bold">Edit Event</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <form id="editEventForm" class="row g-3">

          <div class="col-md-6">
            <label class="form-label fw-semibold">Event Title</label>
            <input type="text" class="form-control" id="editEventTitle" required />
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold">Visibility</label>
            <select class="form-select" id="editEventVisibility" required>
              <option value="poly-wide">Poly-wide</option>
              <option value="cca-specific">CCA Specific</option>
            </select>
          </div>

          <div class="col-12">
            <label class="form-label fw-semibold">Description</label>
            <textarea class="form-control" id="editEventDescription" rows="3"></textarea>
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold">Start Date & Time</label>
            <input type="datetime-local" class="form-control" id="editEventStart" required />
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold">End Date & Time</label>
            <input type="datetime-local" class="form-control" id="editEventEnd" required />
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold">Location</label>
            <input type="text" class="form-control" id="editEventLocation" required />
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold">Capacity</label>
            <input type="number" class="form-control" id="editEventCapacity" min="1" required />
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold">CCA Points Category</label>
            <select class="form-select" id="editEventPointsCategory">
              <option value="">None</option>
              <option value="Service">Service</option>
              <option value="Community Service">Community Service</option>
              <option value="Enrichment">Enrichment</option>
              <option value="Participation">Participation</option>
            </select>
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold">Sign-up Deadline</label>
            <input type="datetime-local" class="form-control" id="editEventSignUpDeadline" />
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold">CCA Points (numeric)</label>
            <input type="number" class="form-control" id="editEventCcaPoints" min="0" step="1" />
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold">Event Image (replace)</label>
            <input type="file" class="form-control" id="editEventImage" accept="image/*" />
            <small class="text-muted">Leave empty to keep existing image.</small>
            <img id="editEventImagePreview" class="mt-2 img-thumbnail d-none" style="max-width:150px; max-height:150px;" />
          </div>

        <div class="col-12">
  <label class="form-label fw-semibold">Agenda</label>
  <textarea class="form-control" id="editEventAgenda" rows="2"></textarea>
</div>

<div class="col-12">
  <label class="form-label fw-semibold">Requirements</label>
  <textarea class="form-control" id="editEventRequirements" rows="2"></textarea>
</div>

<div class="col-12">
  <label class="form-label fw-semibold">Safety Guidelines</label>
  <textarea class="form-control" id="editEventSafety" rows="2"></textarea>
</div>

<div class="col-12">
  <label class="form-label fw-semibold">Additional Notes</label>
  <textarea class="form-control" id="editEventNotes" rows="2"></textarea>
</div>

<div class="col-md-6">
  <label class="form-label fw-semibold">Contact Person</label>
  <input type="text" class="form-control" id="editEventContactPerson" />
</div>

<div class="col-md-6">
  <label class="form-label fw-semibold">Contact Email</label>
  <input type="email" class="form-control" id="editEventContactEmail" />
</div>

<div class="col-md-6">
  <label class="form-label fw-semibold">Contact Phone</label>
  <input type="text" class="form-control" id="editEventContactPhone" />
</div>

        </form>
      </div>

      <div class="modal-footer d-flex justify-content-between">
        <button class="btn btn-danger" id="deleteEventBtn">
          <i class="bi bi-trash"></i> Delete Event
        </button>

        <div>
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-primary" id="saveEventChangesBtn">
            <i class="bi bi-check-lg me-2"></i>Save Changes
          </button>
        </div>
      </div>

    </div>
  </div>
</div>


        <div class="card border-0 shadow-sm mb-4">
          <div class="card-body">
            <h4 class="fw-bold mb-3">Contact Information</h4>

            <div class="row">
              <div class="col-md-4 mb-2">
                <strong>Contact Person:</strong>
                <p id="eventContactName" class="mb-0 text-muted"></p>
              </div>

              <div class="col-md-4 mb-2">
                <strong>Email:</strong>
                <p id="eventContactEmail" class="mb-0 text-muted"></p>
              </div>

              <div class="col-md-4 mb-2">
                <strong>Phone:</strong>
                <p id="eventContactPhone" class="mb-0 text-muted"></p>
              </div>
            </div>
          </div>
        </div>

        

        <div class="card border-0 shadow-sm mb-4">
          <div class="card-body">
            <h4 class="fw-bold mb-3">Attached Files</h4>
            <p class="text-muted">
              Posters, detailed location guides, or other relevant files.
            </p>

            <ul id="eventFilesList" class="list-group"></ul>
          </div>
        </div>
      </div>
    </div>

    <div
      id="toastContainer"
      class="toast-container position-fixed bottom-0 end-0 p-3"
    ></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script>
      const SUPABASE_URL = "https://fyfyvadrabgptmbiuvcl.supabase.co";
      const SUPABASE_KEY =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ5Znl2YWRyYWJncHRtYml1dmNsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMDE5OTYsImV4cCI6MjA3ODc3Nzk5Nn0.kcqDjL3ZaZVOlVU7sDlcl6x5MxrWPlZ_681hzYbbSbQ";

      window.supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script src="../js/utils.js"></script>

    <script src="../js/notifications.js"></script>
    <script src="../js/dashboard-notifications.js"></script>

    <script src="../js/event-details.js"></script>

    <script src="../js/edit-event.js"></script>

 

    <link rel="stylesheet" href="../css/chatbot.css" />

    <div id="chatbot-container">
      <button id="chatbot-fab" class="chatbot-fab" title="Open AI Assistant">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path
            d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
          ></path>
        </svg>
      </button>

      <div id="chatbot-modal" class="chatbot-modal hidden">
        <div class="chatbot-header">
          <div class="chatbot-title">
            <h3>AI Assistant</h3>
            <p>Ask me anything about this website</p>
          </div>
          <button
            id="chatbot-close"
            class="chatbot-close"
            title="Close chatbot"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>

        <div id="chatbot-messages" class="chatbot-messages">
          <div class="chatbot-message bot-message">
            <div class="message-content">
              <p>Hi! I'm your AI Assistant. How can I help you today?</p>
            </div>
          </div>
        </div>

        <div class="chatbot-input-area">
          <input
            id="chatbot-input"
            type="text"
            class="chatbot-input"
            placeholder="Type your message..."
            autocomplete="off"
          />
          <button id="chatbot-send" class="chatbot-send" title="Send message">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <line x1="22" y1="2" x2="11" y2="13"></line>
              <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
            </svg>
          </button>
        </div>
      </div>
    </div>
    <script src="../js/chatbot.js"></script>

  </body>
</html>